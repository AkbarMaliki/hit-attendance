(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["page-absen-selfie~31ecd969"],{1276:function(t,e,a){"use strict";var n=a("d784"),i=a("44e7"),r=a("825a"),s=a("1d80"),o=a("4840"),l=a("8aa59"),c=a("50c4"),u=a("14c3"),d=a("9263"),p=a("d039"),g=[].push,f=Math.min,h=4294967295,v=!p((function(){return!RegExp(h,"y")}));n("split",2,(function(t,e,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var n=String(s(this)),r=void 0===a?h:a>>>0;if(0===r)return[];if(void 0===t)return[n];if(!i(t))return e.call(n,t,r);var o,l,c,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,v=new RegExp(t.source,p+"g");while(o=d.call(v,n)){if(l=v.lastIndex,l>f&&(u.push(n.slice(f,o.index)),o.length>1&&o.index<n.length&&g.apply(u,o.slice(1)),c=o[0].length,f=l,u.length>=r))break;v.lastIndex===o.index&&v.lastIndex++}return f===n.length?!c&&v.test("")||u.push(""):u.push(n.slice(f)),u.length>r?u.slice(0,r):u}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var i=s(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,i,a):n.call(String(i),e,a)},function(t,i){var s=a(n,t,this,i,n!==e);if(s.done)return s.value;var d=r(t),p=String(this),g=o(d,RegExp),m=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(v?"y":"g"),y=new g(v?d:"^(?:"+d.source+")",b),w=void 0===i?h:i>>>0;if(0===w)return[];if(0===p.length)return null===u(y,p)?[p]:[];var x=0,k=0,S=[];while(k<p.length){y.lastIndex=v?k:0;var I,_=u(y,v?p:p.slice(k));if(null===_||(I=f(c(y.lastIndex+(v?0:k)),p.length))===x)k=l(p,k,m);else{if(S.push(p.slice(x,k)),S.length===w)return S;for(var C=1;C<=_.length-1;C++)if(S.push(_[C]),S.length===w)return S;k=x=I}}return S.push(p.slice(x)),S}]}),!v)},"25f0":function(t,e,a){"use strict";var n=a("6eeb"),i=a("825a"),r=a("d039"),s=a("ad6d"),o="toString",l=RegExp.prototype,c=l[o],u=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=o;(u||d)&&n(RegExp.prototype,o,(function(){var t=i(this),e=String(t.source),a=t.flags,n=String(void 0===a&&t instanceof RegExp&&!("flags"in l)?s.call(t):a);return"/"+e+"/"+n}),{unsafe:!0})},"44e7":function(t,e,a){var n=a("861d"),i=a("c6b6"),r=a("b622"),s=r("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==i(t))}},e1b7:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"py-4 px-2 shadow"},[a("p",{staticClass:"mt-1 font-semibold text-lg float-right mr-3"},[t._v("Selfie")]),a("button",{staticClass:"btn btn-sm btn-dark-outline ml-2 rounded-circle px-2",staticStyle:{border:"1px solid black"},attrs:{type:"button"},on:{click:function(e){return t.$router.go(-1)}}},[a("span",{staticClass:"typcn typcn-arrow-left"})])]),a("div",{staticClass:"row"},[t.streamOn?a("div",{staticClass:"col-sm-12 text-center"},[a("video",{attrs:{autoplay:"",playsInline:"",mutedstyle:"height:60vh; width: 100vh;",id:"videoQRCODE"}}),a("button",{staticClass:"btn btn-sm btn-style13 text-xl mt-5",attrs:{type:"button"},on:{click:t.getImage}},[a("span",{staticClass:"typcn typcn-camera"}),t._v(" Take Picture! ")]),a("canvas",{staticClass:"d-none",staticStyle:{overflow:"auto"},attrs:{id:"canvas"}})]):a("div",{staticClass:"col-sm-12",staticStyle:{height:"100vh"},on:{click:function(e){t.getStream("video"),t.streamOn=!0,t.$forceUpdate()}}},[t._m(0)])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex justify-content-center align-items-center shadow-lg rounded-lg",staticStyle:{height:"90vh"}},[a("div",{staticStyle:{width:"100%"}},[a("p",{staticClass:"text-center text-4xl font-semibold"},[t._v(" Klik disini untuk Start Camera! ")])])])}],r=a("1da1"),s=(a("96cf"),a("e25e"),a("1276"),a("ac1f"),a("d3b7"),a("25f0"),a("0d03"),a("2b3d"),a("3ca3"),a("ddb0"),a("c0b6"),a("bc3a")),o=a.n(s),l=a("2f0b"),c=new l["a"]("ci"),u={data:function(){return{isIos:!1,countIos:0,streamOn:!1}},methods:{prosesAbsen:function(t){var e=this;c.loadingOn();var a=localStorage.getItem("absenStatus");a=JSON.parse(a);var n=new FormData;n.append("id_user",a.data.nrp),n.append("force","true"),n.append("file",t),o.a.post("https://wajah.officialapp.my.id/api/face/recognition",n).then(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){var i,r,s,l,u,d,p,g,f,h,v,m,b,y,w,x,k,S,I;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(c.loadingOff(),console.log("res",n),i=n.data,console.log(i),0!=i.status){t.next=8;break}alert("Wajah tidak ditemukan"),t.next=58;break;case 8:if(i.id_user==a.data.nrp){t.next=12;break}alert("Wajah terdetect bukan milik user ini !"),t.next=58;break;case 12:if(!(Math.round(i.confidence)<55)){t.next=16;break}alert("Confidence data kurang dari 50%!"),t.next=58;break;case 16:if(r=a.data.timezone,"IN"!=e.$route.query.type){t.next=40;break}return t.next=20,o.a.get("https://wajah.officialapp.my.id/api/get/server_date");case 20:s=t.sent,l=parseInt(s.data.split(" ")[1].substring(0,2)),s=s.data,u=s.split(" ")[0],d=s.split(" ")[1].split(":")[1],p=s.split(" ")[1].split(":")[2],g=":"+d+":"+p,"WITA"==r?(l+=1,l=l.toString(),1==l.length&&(l="0"+l),g=u+" "+l+g):"WIT"==r&&(l+=2,l=l.toString(),1==l.length&&(l="0"+l),g=u+" "+l+g),f=g,h=e.$route.query.target,v=new FormData,v.append("nrp",i.id_user),v.append("lat",e.$route.query.lat),v.append("long",e.$route.query["long"]),v.append("clock_in_time",f),v.append("working_location",h),o.a.post("https://officialapp.my.id/api/bridge/clock_in",v,{"Content-Type":"multipart/form-data"}).then((function(t){c.alert("Absen Masuk Berhasil","bg-green-400"),e.$router.push("/main")})),alert("proses absen masuk ini "+i.id_user),t.next=58;break;case 40:return t.next=42,o.a.get("https://wajah.officialapp.my.id/api/get/server_date");case 42:m=t.sent,b=parseInt(m.data.split(" ")[1].substring(0,2)),m=m.data,y=m.split(" ")[0],w=m.split(" ")[1].split(":")[1],x=m.split(" ")[1].split(":")[2],k=":"+w+":"+x,"WITA"==r?(b+=1,b=b.toString(),1==b.length&&(b="0"+b),k=y+" "+b+k):"WIT"==r&&(b+=2,b=b.toString(),1==b.length&&(b="0"+b),k=y+" "+b+k),S=k,I=new FormData,I.append("nrp",i.id_user),I.append("lat",e.$route.query.lat),I.append("long",e.$route.query["long"]),I.append("clock_out_time",S),o.a.post("https://officialapp.my.id/api/bridge/clock_out",I,{"Content-Type":"multipart/form-data"}).then((function(t){e.$router.push("/main"),c.alert("Absen Pulang Berhasil","bg-green-400")})),alert("proses absen keluar ini "+i.id_user);case 58:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())["catch"]((function(t){c.loadingOff(),alert(JSON.stringify(t))}))},getImage:function(){var t=this,e=document.getElementById("videoQRCODE"),a=document.getElementById("canvas");a.width=e.videoWidth,a.height=e.videoHeight,a.getContext("2d").drawImage(e,0,0,e.videoWidth,e.videoHeight),a.toBlob((function(e){var a=new File([e],"photo.jpg",{type:"image/jpeg"});t.prosesAbsen(a)}),"image/jpeg")},getStream:function(t){if(navigator.mediaDevices||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia){var e={};e[t]=!0,this.getUserMedia(e).then((function(e){var a=document.querySelector(t);"srcObject"in a?a.srcObject=e:navigator.mozGetUserMedia?a.mozSrcObject=e:a.src=(window.URL||window.webkitURL).createObjectURL(e),a.play()}))["catch"]((function(t){alert("Error: "+t)}))}else alert("User Media API not supported.")},getUserMedia:function(t){if(navigator.mediaDevices)return navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return e?new Promise((function(a,n){e.bind(navigator)(t,a,n)})):void 0},formatTgl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return this.$datefns.format(new Date(t),e)}},mounted:function(){localStorage.getItem("users")||this.$router.push("/")}},d=u,p=a("2877"),g=Object(p["a"])(d,n,i,!1,null,null,null);e["default"]=g.exports}}]);
//# sourceMappingURL=page-absen-selfie~31ecd969.de8afaec.js.map